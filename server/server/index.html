<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>~ Moshi ~</title>
    <link rel="stylesheet" href="/style.css">
    <style>
      #nerd-stuff {
        display: none;
      }
    </style>
</head>
<body>

<div class="top-container">
<h1>Moshi</h1>
<p>
  Moshi is a language speaking tutor.
</p>
</div>

<div class="container">
<h2>Instructions</h2>
<ol>
  <li>Click the Start button,</li>
  <li>Wait for the signal,</li>
  <li>Start speaking in some language.</li>
</ol>
<br>
<p>
  For example, when you get the signal, say: "Hola, mi nombre es Jeff".<br>
  Then, wait for Moshi to respond - and continue your conversation!
</p>
<p>
  Odds are your language is supported.<br>
  If not, please mail <tt>moshi.feedback@gmail.com</tt>.<br>
</p>

<p>
  <button id="start" onclick="start()">Start</button>
  <button id="stop" style="display: none" onclick="stop()">Stop</button>
</p>

<h2>Audio status</h2>
<p>
  <audio id="audio" autoplay controls></audio>
</p>

<h2>Transcript</h2>
<p>
<pre id="transcript" style="height: 200px;"></pre>
</p>

<hr>
<p>
Moshi version <tt>alpha-23.6.1</tt><br>
Â© 2023 Eric Kalosa-Kenyon. All rights reserved.
</p>
<h1>Nerd stuff</h1>
<h2>Troubleshooting</h2>
<ul>
  <li>Your microphone and speaker must be enabled - press "Allow" when your web browser asks for permission.</li>
</ul>

<br>
<button id="showNerdStuff">Show diagnostics</button>

<div id="nerd-stuff">
<p>
The following sections are exposed in this alpha release for diagnostic purposes (and for nosy nerds).
You don't need to touch anything here, and if you don't know what you're doing, you shouldn't.
</p>

<h2>Ping-pong</h2>
<p>
The following text shows your ping, which tells you the speed of your connection over the Internet to the Moshi server.
It won't show anything until you click start, and after that it should show ping pong until you click stop.
</p>
<pre id="data-channel" style="height: 200px;"></pre>

<h2>WebRTC Connection Options</h2>
<p>
Don't mess with these unless you know what you're doing.
</p>
<div class="option">
    <input id="use-datachannel" checked="checked" type="checkbox"/>
    <label for="use-datachannel">Use datachannel</label>
    <select id="datachannel-parameters">
        <option value='{"ordered": true}'>Ordered, reliable</option>
        <option value='{"ordered": false, "maxRetransmits": 0}'>Unordered, no retransmissions</option>
        <option value='{"ordered": false, "maxPacketLifetime": 500}'>Unordered, 500ms lifetime</option>
    </select>
</div>
<div class="option">
    <input id="use-audio" checked="checked" type="checkbox"/>
    <label for="use-audio">Use audio</label>
    <select id="audio-codec">
        <option value="default" selected>Default codecs</option>
        <option value="opus/48000/2">Opus</option>
        <option value="PCMU/8000">PCMU</option>
        <option value="PCMA/8000">PCMA</option>
    </select>
</div>
<div class="option">
    <input id="use-stun" type="checkbox"/>
    <label for="use-stun">Use STUN server</label>
</div>

<h2>WebRTC Connection State</h2>
<p>
These elements will populate with the status of your connection to the Moshi server.
</p>
<p>
    ICE gathering state: <span id="ice-gathering-state"></span>
</p>
<p>
    ICE connection state: <span id="ice-connection-state"></span>
</p>
<p>
    Signaling state: <span id="signaling-state"></span>
</p>

<h2>WebRTC Connection Description (SDP)</h2>
<p>The session description protocol tells you details about the connection that is established (or being established,
initially) to the Moshi server - mostly about the WebRTC middleman server (an ICE or STUN server provided by Google).
<h3>Offer</h3>
<pre id="offer-sdp"></pre>
<h3>Answer</h3>
<pre id="answer-sdp"></pre>


<script src="client.js"></script>

</div>  <!-- container div -->
</body>
</html>
